<html>
<head>
<style>
body{
  margin: 0;
}
</style>
</head>
<body>
<canvas id="canvas"></canvas>

<script>
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

var obj = function(){
  this.x = 0;
  this.y = 0;
  this.width = 20;
  this.height = 10;
  this.vx = 5;
  this.vy = 5;
  this.render = function( context ){
    context.beginPath();
    context.fillRect( this.x, this.y, this.width, this.height );
    context.stroke();
  };
};

var scene = function(){
  this.fps = 50;
  this.interval = 1 / this.fps * 1000;
  this.children = [];
  this.now = 0;
  this.past = 0;
  this.diff = 0;
  this.context = ctx;
  this.addChild = function( obj ){
    this.children.push( obj );
  };
  this.setContext = function( context ){
    this.context = context;
  };
  this.render = function(){
    for( var i in this.children ){
      var child = this.children[i];
      this.context.fillRect( child.x, child.y, child.width, child.height );
    }
  };
  this.clear = function(){
    this.context.clearRect( 0, 0, canvas.width, canvas.height );
  };
  this.tick = function(){
    this.clear();
    this.now = new Date().getTime();
    if( this.past > 0 ) {
      this.diff = this.now - this.past;
    }
    else {
      this.diff = this.interval;
    }
    this.past = this.now;
    for( var i in this.children ){
      var child = this.children[i];
      child.x += child.vx * ( this.diff / this.interval );
      child.y += child.vy * ( this.diff / this.interval );
      child.vx = (child.x < 0 || child.x > canvas.width) ? -child.vx : child.vx;
      child.vy = (child.y < 0 || child.y > canvas.height) ? -child.vy : child.vy;
      child.render( ctx );
    }
  };
};
var a = new obj();
var b = new scene();
b.addChild(a);
setInterval( function(){b.tick();}, b.interval )

</script>
</body>
</html>
